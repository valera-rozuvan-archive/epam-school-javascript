<html>
  <head>
    <title>Sample JavaScript code</title>
  </head>
  <body>
    <div id="some_text">Hello, world</div>

    <script type="text/javascript">
      // Execute a callback function when DOM is loaded.
      function ready(callback) {
        if (document.readyState != 'loading'){
          callback();
        } else {
          document.addEventListener('DOMContentLoaded', callback);
        }
      }

      // Main entry point of our code. All sample code should be placed
      // in this function.
      function main() {
        AudiMotors = new CarFactory();
        AudiMotorsKievStore = new CarShop();
        Vasia = new Person();

        // Vasia.name = '''
        // Vaisa.age = '''

        carsMediator = new CarsMediator();

        cars = new CarsCollection();

        carsMediator.addFactory(AudiMotors);
        carsMediator.addStore(AudiMotorsKievStore);
        carsMediator.addCustomer(Vasia);

        carsMediator.addCarCollection(cars);

        // .....

        // Vasia.lookForCar('Audi A4', function (car) {
        //   if (car.speed >= 200) {
        //     Vasia.buyCar(car);
        //   }
        // });

        Vasiya.subscribe('new Audi A4', function (car) {
          if (car.speed >= 200) {
            Vasia.buyCar(car);
          }
        });

        AudiMotorsKievStore.howManyCarsSold(); // + 1
      }

      // Call the function main() when DOM is loaded.
      ready(main);
    </script>
  </body>
</html>
